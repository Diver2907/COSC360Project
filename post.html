<!DOCTYPE html>
<html lang="en">
    <head>
        <link rel="stylesheet" href="Style.css"/>
        <title>Home</title>
    </head>
    <body>
        <div class="top-bar">
            <h1>BlogSphere</h1>
            
        </div>
        <div class="right-nav">
            <ul>
                <li><a href="home.html">Home</a></li>
                <li><a href="profile.html">Profile</a></li>
                <li><a href="friends.html">Friends</a></li>
                <li class="active"><a href="post.html">Post</a></li>
                <li><a href="settings.html">Settings</a></li>
                <li><a href="ts-cs.html">Terms and Conditions</a></li>
                <li><a href="index.html">Logout</a></li>
            </ul>
        </div>
        <div class="main-content">
            <h2>Create a New Post</h2>
    <form id="post-form">
      <label for="post-text">Post Text:</label>
      <textarea id="post-text" placeholder="Write your post here..." required></textarea>
      
      <label for="post-image">Upload an Image:</label>
      <input type="file" id="post-image" accept="image/*">
      
      <button type="submit">Submit Post</button>
    </form>
    
    <!-- Container where the new post is displayed immediately -->
    <div id="post-container"></div>
  </div>

  <script>
    // Handle the form submission
    document.getElementById('post-form').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const text = document.getElementById('post-text').value;
      const file = document.getElementById('post-image').files[0];
      const postContainer = document.getElementById('post-container');

      // Create a new post element for immediate feedback
      const postDiv = document.createElement('div');
      postDiv.className = 'post';

      // Function to save the post in localStorage
      function savePost(imageData) {
        // Retrieve existing posts or start with an empty array
        const posts = JSON.parse(localStorage.getItem('posts')) || [];
        const newPost = {
          text: text,
          image: imageData || '',
          timestamp: new Date().toISOString()
        };
        posts.push(newPost);
        localStorage.setItem('posts', JSON.stringify(posts));
      }

      // Create the text element for the post
      const textParagraph = document.createElement('p');
      textParagraph.textContent = text;

      // If an image file is selected, read it and add it to the post
      if (file) {
        const reader = new FileReader();
        reader.onload = function(event) {
          const imageData = event.target.result;
          const image = document.createElement('img');
          image.src = imageData;
          image.alt = 'Post Image';
          // Insert the image at the top of the post
          postDiv.appendChild(image);
          postDiv.appendChild(textParagraph);
          postContainer.appendChild(postDiv);
          // Save the post including image data
          savePost(imageData);
        };
        reader.readAsDataURL(file);
      } else {
        // If no image, just add the text
        postDiv.appendChild(textParagraph);
        postContainer.appendChild(postDiv);
        savePost('');
      }

      // Clear the form for the next post
      document.getElementById('post-form').reset();
    });
  </script>
    </body>
</html>